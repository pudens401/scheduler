// Patient dashboard route (simplified)
router.get(
  '/dashboard/patient',
  authMiddleware,
  roleMiddleware(['patient']),
  async (req, res) => {
    try {
      const user = await User.findById(req.user.userId).populate('device');
      const deviceId = user.device.deviceId;
      const scheduleData = user.device.schedule || [];
      
      // No need to fetch notifications here anymore
      res.render('patientDashboard', {
        user,
        deviceId,
        scheduleData
        // Remove notifications from here
      });
    } catch (err) {
      console.error('Dashboard error:', err);
      res.status(500).send('Error loading dashboard');
    }
  }
);