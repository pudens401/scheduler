<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sign Up</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-white text-black">
  <div class="flex items-center justify-center min-h-screen px-4">
    <div class="w-full max-w-md p-6 bg-white rounded shadow-lg">
      <h2 id="signupTitle" class="text-2xl font-bold text-center text-gray-900">Create Account</h2>

      <% if (typeof error !== 'undefined' && error) { %>
        <div class="mt-2 p-3 bg-red-100 text-red-700 rounded"><%= error %></div>
      <% } %>

      <form action="/users/signup" method="POST" class="mt-4 space-y-4">
        <input
          type="text"
          name="name"
          placeholder="Name"
          class="w-full px-4 py-2 border rounded text-black focus:outline-none"
          required
        />

        <input
          type="email"
          name="email"
          placeholder="Email"
          class="w-full px-4 py-2 border rounded text-black focus:outline-none"
          required
        />

        <input
          type="password"
          name="password"
          placeholder="Password"
          class="w-full px-4 py-2 border rounded text-black focus:outline-none"
          required
        />

        <select
          name="role"
          id="roleSelect"
          class="w-full px-4 py-2 border rounded text-black focus:outline-none"
          required
        >
          <option value="">Select Role</option>
          <option value="patient">Patient</option>
          <option value="caretaker">Caretaker</option>
          <option value="farmer">Farmer</option>
          <option value="ringer">Ringer</option>
        </select>

        <div id="deviceGroup" class="">
          <input
            type="text"
            name="deviceId"
            id="deviceIdInput"
            placeholder="Device ID (required for patient, farmer, or ringer)"
            class="w-full px-4 py-2 border rounded text-black focus:outline-none"
          />
        </div>

        <button
          id="signupSubmit"
          type="submit"
          class="w-full px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded transition"
        >
          Sign Up
        </button>
      </form>
      <p class="mt-4 text-center text-sm text-gray-700">
        Already have an account?
        <a href="/users/login" class="text-orange-600 hover:underline">Log in</a>
      </p>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const roleSelect = document.getElementById('roleSelect');
      const deviceGroup = document.getElementById('deviceGroup');
      const deviceInput = document.getElementById('deviceIdInput');
      const title = document.getElementById('signupTitle');
      const submitBtn = document.getElementById('signupSubmit');

      function applyRoleUI(role) {
        const needsDevice = ['patient', 'farmer', 'ringer'].includes(role);
        deviceGroup.classList.toggle('hidden', !needsDevice);
        deviceInput.required = needsDevice;
        deviceInput.placeholder = needsDevice
          ? 'Device ID (required for patient, farmer, or ringer)'
          : 'Device ID';

        // Orange theme emphasis when ringer is selected
        if (role === 'ringer') {
          title.classList.remove('text-gray-900');
          title.classList.add('text-orange-700');
          submitBtn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
          submitBtn.classList.add('bg-orange-500', 'hover:bg-orange-600');
        } else {
          title.classList.remove('text-orange-700');
          title.classList.add('text-gray-900');
          submitBtn.classList.add('bg-orange-500', 'hover:bg-orange-600');
        }
      }

      // Initial state
      applyRoleUI(roleSelect.value || '');

      roleSelect.addEventListener('change', (e) => applyRoleUI(e.target.value));
    });
  </script>
</body>
</html>
